<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>面对对象的轮播图</title>
	<style>
		#box1{
			position: relative;
			width: 400px;
			height: 300px;
		}
		#box2{
			position: relative;
			width: 600px;
			height: 400px;
		}
	</style>
</head>
<body>
	<div id="box1"></div>
	<br>
	<div id="box2"></div>
</body>
</html>
<script type="text/javascript">
	function Banner(boxDom,width,height,imgs,IsCircle,douSize,douColor,douLightColor,douPostion,timerSpace){
		this.boxDom=boxDom;
		this.imgDoms = [];//存放图片的地址
		this.width=width;
		this.height=height;
		this.imgs = imgs;
		this.IsCircle = IsCircle;
		this.douSize = douSize;
		this.douColor = douColor;
		this.douLightColor = douLightColor;
		this.douPostion = douPostion;
		this.timerSpace = timerSpace;
		this.myTimer = null;
		this.currOrd = 0;
		this.createUI();
		this.autoPlay();
		this.addEvent();

	}
	Banner.prototype.createUI=function(){
		//1.创建图片
		for (let i = 0; i < this.imgs.length; i++) {
			let imgDom=document.createElement('img');
			imgDom.src=this.imgs[i];
			imgDom.style.cssText=`position: absolute;
				left:0px;
				top:0px;
				width: ${this.width}px;
				height: ${this.height}px;
				opacity: 0;`;
			if (i=='0') {
				imgDom.style.opacity=1;
			}
			this.boxDom.appendChild(imgDom);
			this.imgDoms.push(imgDom);
		}
		//2.创建ul
		let ulDom=document.createElement('ul');
		ulDom.style.cssText =`
				margin:0;
				padding:0;
				position: absolute;
				list-style: none;
				z-index: 3;`;
		switch(this.douPostion){
			case '上':{
				ulDom.style.top=this.height*0.05+'px',//ulDom.style.top = this.height*0.05+"px",
				ulDom.style.left=(this.width-this.douSize*2*this.imgs.length)/2+'px';
			};break;
			case '下':{
				ulDom.style.bottom=this.height*0.05+'px',
				ulDom.style.left=(this.width-this.douSize*2*this.imgs.length)/2+'px';
			};break;
			case '左':{
				ulDom.style.left=this.width*0.05+'px',
				ulDom.style.top=(this.height-this.douSize*2*this.imgs.length)/2+'px';
			};break;
			case '右':{
				ulDom.style.right=this.width*0.05+'px',
				ulDom.style.top=(this.height-this.douSize*2*this.imgs.length)/2+'px';
			};break;
			default:;break;
		}
		this.boxDom.appendChild(ulDom);
		//3.创建li
		for(let i in this.imgs){
			let liDom=document.createElement('li');
			liDom.style.cssText=`
			margin:0;
			padding:0;
			float:left;
			width:${this.douSize}px;
			height: ${this.douSize}px;
			margin-right:${this.douSize/2}px;
			margin-left:${this.douSize/2}px;
			background-color:${this.douColor};
			`;
			if (this.douPostion=='左'||this.douPostion=='右') {
				liDom.style.float="none";
				liDom.style.marginTop=this.douSize/2+'px';
				liDom.style.marginBottom=this.douSize/2+'px';
			}
			if (this.IsCircle) {
				liDom.style.borderRadius="50%";
			}
			if (i=='0') {
				liDom.style.backgroundColor=this.douLightColor;
			}
			ulDom.appendChild(liDom);
		}
	}
	Banner.prototype.autoPlay=function(){
		let liDoms=this.boxDom.lastElementChild.children;
		if(this.myTimer!=null){
			return;
		}
		this.myTimer=setInterval(()=>{
			let outOrd=this.currOrd;
			this.currOrd++;
			if (this.currOrd>this.imgs.length-1) {
				this.currOrd=0;
			}
			fadeInOut(this.imgDoms[this.currOrd],this.imgDoms[outOrd],1500);
			//点点
			for (let i = 0; i < this.imgs.length; i++) {
				liDoms[i].style.backgroundColor=this.douColor;
			}
			liDoms[this.currOrd].style.backgroundColor=this.douLightColor;
		},this.timerSpace);
	}
	Banner.prototype.stopPlay=function(){
		clearInterval(this.myTimer);
		this.myTimer=null;
	}
	Banner.prototype.goImg=function(ord) {
		let liDoms=this.boxDom.lastElementChild.children;
			let outOrd=this.currOrd;
			this.currOrd=ord;
			if (this.currOrd>this.imgs.length-1) {
				this.currOrd=0;
			}
			fadeInOut(this.imgDoms[this.currOrd],this.imgDoms[outOrd],1500);
			//点点
			for (let i = 0; i < this.imgs.length; i++) {
				liDoms[i].style.backgroundColor=this.douColor;
			}
			liDoms[this.currOrd].style.backgroundColor=this.douLightColor;
	}
	Banner.prototype.addEvent=function () {
		this.boxDom.onmouseenter=()=> {
			this.stopPlay();
		}
		this.boxDom.onmouseleave=()=> {
			this.autoPlay();
		}
		let liDoms=this.boxDom.lastElementChild.children;
		for (let i = 0; i < liDoms.length; i++) {
			liDoms[i].onclick=()=> {
				this.goImg(i);
			}
		}
	}
	window.onload=function(){
		new Banner($("#box1"),400,300,['img/4.jpg','img/3.jpg','img/2.jpg','img/1.jpg'],true,20,'pink','red','上',3000);
		new Banner($("#box2"),450,350,['img/8.jpg','img/7.jpg','img/6.jpg','img/5.jpg','img/3.jpg'],false,16,'lightblue','lightgreen','左',4000);
	}
	function $(str){
	if(str.charAt(0)=="#"){
		return document.getElementById(str.substring(1));
	}else if(str.charAt(0)=="."){
		return document.getElementsByClassName(str.substring(1));
	}else{
		return document.getElementsByTagName(str);
	}
}
	function fadeInOut(domObjIn,domObjOut,timeLong){
		let opacity=0;
		let timerSpace=20;
		let step=1/(timeLong/timerSpace);
		let myTimer=setInterval(function(){
			opacity+=step;
			if (opacity>=1) {
				opacity=1;
				clearInterval(myTimer);
			}
			domObjIn.style.opacity=opacity;
			domObjOut.style.opacity=1-opacity;
		},timerSpace);
	}
</script>